def setExtValue(String property, String systemEnvVarName) {
    project.ext."$property" = project.hasProperty(property) ? project.getProperty(property) : System.getenv(systemEnvVarName)
}

setExtValue('ghToken', 'GITHUB_TOKEN')
setExtValue('gradle.publish.key', 'GRADLE_PUBLISH_KEY')
setExtValue('gradle.publish.secret', 'GRADLE_PUBLISH_SECRET')